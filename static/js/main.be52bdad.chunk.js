(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,a){e.exports=a(298)},150:function(e,t,a){},298:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(18),o=a.n(i),s=(a(150),a(26)),l=a(27),c=a(29),u=a(28),p=a(30),d=a(5),m=a(85),g=a.n(m),h=a(24),f=a.n(h),b=a(13),y=a.n(b),v=a(141),S=a.n(v),E=a(81),M=a.n(E),T=a(33),w=a.n(T),N=a(35),O=a.n(N),F=a(54),I=a(55),C=a(95),k={STATE:Symbol("state"),TRANSITION:Symbol("transition")};Object.freeze(k);var j=function(e){return"function"===typeof e.getProcessorsList?k.STATE:k.TRANSITION};function B(e){return e===Object(e)}var P=function(e,t){if(t){for(var a=(t=t.replace(/^\./,"")).split("."),r=0,n=a.length;r<n;++r){var i=a[r];if(!(B(e)&&i in e))return;e=e[i]}return e}},R=function(e,t){var a=null;return t.getStatesList().map(function(t){return t.getName()===e&&(a=t),null}),a},L=function(e,t){var a=null;return t.getStatesList().map(function(t){return t.getTransitionsList().map(function(r){return r===e&&(a=t),null}),null}),a},_=function(e,t){var a={callable:[]},r=j(e),n=e.getName();switch(a.name=n,r){case k.STATE:a.isStartState=e.getName()===t.getStartState();break;case k.TRANSITION:a.to=e.getNextState(),a.from=L(e,t).getName(),a.instruction={},a.instruction.audio=e.getInstruction().getAudio(),a.instruction.image=e.getInstruction().getImage(),a.instruction.video=e.getInstruction().getVideo();break;default:throw new Error("Unsupported Element Type: "+r+". Failed to add a new element")}return a.callable=function(e){var t=[];return e.map(function(e){var a={};a.name=e.getName(),a.type=e.getCallableName();var r=JSON.parse(e.getCallableArgs());return a.args={},Object.keys(r).map(function(e){return a.args[e]=r[e],null}),t.push(a),null}),t}(function(e){var t=j(e),a=null;switch(t){case k.STATE:a=e.getProcessorsList();break;case k.TRANSITION:a=e.getPredicatesList();break;default:throw new Error("Unsupported Element Type: "+t+". Failed to add a new element")}return a}(e)),a},A=function(e,t,a,r){for(var n=[],i=function(t){var i=e[t],o=new a;o.setName(i.name),o.setCallableName(i.type);var s={};Object.keys(r[i.type]).map(function(e){return s[e]=i.args[e],null}),o.setCallableArgs(JSON.stringify(s)),n.push(o)},o=0;o<e.length;o++)i(o);t(n)},U=function(e){var t=[],a=!0;return e.getStatesList().map(function(e){return t.includes(e.getName())&&(a=!1),t.push(e.getName()),e.getTransitionsList().map(function(e){return t.includes(e.getName())&&(a=!1),t.push(e.getName()),null}),null}),a},W=function(e){var t=[];return e.getStatesList().map(function(e){return t.push(e.getName()),e.getTransitionsList().map(function(e){return t.push(e.getName()),null}),null}),t},x=function(e,t,a,r){var n=null,i=W(t);if(null===r||void 0===r){if(i.includes(e.name))throw"Error: Duplicate name! All states and transitions must have unique names.";switch(a){case k.STATE:n=new C.State,t.addStates(n);break;case k.TRANSITION:n=new C.Transition,R(e.from,t).addTransitions(n);break;default:throw new Error("Unsupported Element Type: "+a+". Failed to add a new element")}}else{if(i.includes(e.name)&&r.getName()!==e.name)throw"Error: Duplicate name! All states and transitions must have unique names.";n=r}switch(a){case k.STATE:!function(e,t,a){var r=a.fsm,n=e.getName();n&&r.getStatesList().map(function(e){return e.getTransitionsList().map(function(e){return e.getNextState()===n&&e.setNextState(t),null}),null}),e.setName(t)}(n,e.name,{fsm:t}),e.isStartState&&t.setStartState(e.name),A(e.callable,n.setProcessorsList.bind(n),C.Processor,F);break;case k.TRANSITION:n.setName(e.name),function(e,t,a){var r=a.fsm,n=L(e,r);if(t!==n.getName()){var i=n.getTransitionsList().indexOf(e);i>-1&&n.getTransitionsList().splice(i,1),R(t,r).addTransitions(e)}}(n,e.from,{fsm:t,oldFromStateName:e.from}),n.setNextState(e.to);var o=new C.Instruction;e.instruction&&(o.setAudio(e.instruction.audio),o.setImage(e.instruction.image),o.setVideo(e.instruction.video)),n.setInstruction(o),A(e.callable,n.setPredicatesList.bind(n),C.TransitionPredicate,I);break;default:throw new Error("Unsupported Element Type: "+a+". Failed to add a new element")}};function z(e,t){if((t=t.model||t)instanceof w.a.dia.Element)O.a.chain(e.getConnectedLinks(t)).groupBy(function(e){return O.a.omit([e.source().id,e.target().id],t.id)[0]}).each(function(t,a){"undefined"!==a&&z(e,O.a.first(t))}).value();else{var a=t.get("source").id||t.previous("source").id,r=t.get("target").id||t.previous("target").id;if(a&&r){var n=e.getLinks().filter(function(e){var t=e.source().id,n=e.target().id;return t===a&&n===r||t===r&&n===a}),i=n.length;switch(i){case 0:break;default:1===i&&t.unset("vertices");var o=e.getCell(a).getBBox().center(),s=e.getCell(r).getBBox().center(),l=w.a.g.Line(o,s).midpoint(),c=o.theta(s);O.a.each(n,function(e,t){var a=20*Math.ceil(t/2),r=t%2?1:-1;i%2===0&&(a-=10*r);var n=c<180?1:-1,o=w.a.g.toRad(c+r*n*90),s=w.a.g.Point.fromPolar(a,o,l);e.vertices([s])})}}else t.unset("vertices")}}w.a.shapes.basic.Circle.define("fsa.State",{attrs:{circle:{"stroke-width":2},text:{"font-weight":"800"}}}),w.a.shapes.standard.Link.define("fsa.CustomArrow",{attrs:{line:{sourceMarker:{type:"circle",width:5,stroke:"none"}}},smooth:!0});var D=function(e){function t(e){var a;Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).graph=new w.a.dia.Graph;var r=O.a.partial(z,a.graph);return a.graph.on("add remove change:source change:target",r),a.state_shape_width=50,a.state_shape_height=50,a.state_spacing_x=200,a.state_spacing_y=150,a.state_per_row=3,a.cellId2FSMElement={},a.name2Cell=new Map,a.renderAllStates=a.renderAllStates.bind(Object(d.a)(Object(d.a)(a))),a.renderAllTransitions=a.renderAllTransitions.bind(Object(d.a)(Object(d.a)(a))),a.getStateName2CellMap=a.getStateName2CellMap.bind(Object(d.a)(Object(d.a)(a))),a.clearGraph=a.clearGraph.bind(Object(d.a)(Object(d.a)(a))),a.removeUnusedCells=a.removeUnusedCells.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.onClickCell,a=e.onClickBlank,r=e.paperWidth;this.$el=M()(this.el),console.log("paper width is: "+r);var n=new w.a.dia.Paper({el:this.$el,width:r,height:5*r,gridSize:1,model:this.graph,restrictTranslate:!0});n.on("cell:pointerdblclick",t),n.on("cell:pointerclick",t),n.on("blank:pointerclick",a),n.on("blank:pointerclick",a),this.state_per_row=Math.floor(parseInt(n.options.width,10)/(this.state_shape_width+this.state_spacing_x))+1}},{key:"componentWillUnmount",value:function(){this.graph.clear(),this.cellId2FSMElement={}}},{key:"componentDidUpdate",value:function(){}},{key:"handleStateCallback",value:function(e){this.stateCells.push(e)}},{key:"renderAllStates",value:function(e){var t=this;return e.getStatesList().map(function(a,r){if(!t.name2Cell.has(a.getName())){var n=(i=Math.floor(r%t.state_per_row)*t.state_spacing_x,o=Math.floor(r/t.state_per_row)*t.state_spacing_y,s=a.getName(),new w.a.shapes.fsa.State({position:{x:i,y:o},size:{width:100,height:100},attrs:{text:{text:s}}}));e.getStartState()===a.getName()&&n.attr("circle/stroke-width","5"),a.getProcessorsList().map(function(e){return e.getCallableName()}).includes("GatedTwoStageProcessor")&&n.attr("circle/fill","yellow"),t.addGraphCellWithRef(a.getName(),n,a)}var i,o,s;return null},this)}},{key:"renderAllTransitions",value:function(e){var t=this,a=e.getStatesList(),r=this.getStateName2CellMap();return a.map(function(e){return e.getTransitionsList().map(function(a){if(!t.name2Cell.has(a.getName())){var n=(i=r[e.getName()],o=r[a.getNextState()],s=a.getName(),new w.a.shapes.fsa.CustomArrow({source:{id:i.id},target:{id:o.id},labels:[{position:.5,attrs:{text:{text:s||""}}}]}));t.addGraphCellWithRef(a.getName(),n,a)}var i,o,s;return null},t)},this)}},{key:"getStateName2CellMap",value:function(){var e=this.graph.getElements(),t={};return e.map(function(e){var a=e.attr("text/text");return a in t?console.error("Duplicate State Name: "+a):t[a]=e,null}),t}},{key:"addGraphCellWithRef",value:function(e,t,a){this.graph.addCell(t),this.cellId2FSMElement[t.id]=a,this.name2Cell.set(e,t)}},{key:"clearGraph",value:function(){this.graph.clear(),this.cellId2FSMElement={},this.name2Cell.clear()}},{key:"removeUnusedCells",value:function(e){var t=this,a=W(e),r=[],n=!0,i=!1,o=void 0;try{for(var s,l=this.name2Cell.keys()[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var c=s.value;a.includes(c)||r.push(c)}}catch(u){i=!0,o=u}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}r.forEach(function(e){return t.graph.removeCells(t.name2Cell.get(e)),t.name2Cell.delete(e),null})}},{key:"render",value:function(){var e=this,t=this.props.fsm;return null!=t&&(this.removeUnusedCells(t),this.renderAllStates(t),this.renderAllTransitions(t)),n.a.createElement("div",{ref:function(t){return e.el=t}})}}]),t}(r.Component),V=(a(65),a(143)),G=a(60),H=a(38),K=a(130),J=a.n(K),$=a(32),q=a.n($),Y=(a(96),a(56)),Q=a.n(Y),X=a(57),Z=a.n(X),ee=function(e,t,a){var r=Math.max.apply(Math,Object(V.a)(e.map(function(e){return("".concat(e[t])||"").length})).concat([a.length]));return Math.min(100,11*r)},te=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).imageInstUrl=null,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"prepareResource",value:function(e){var t={};if(null!==this.imageInstUrl&&URL.revokeObjectURL(this.imageInstUrl),null!==this.videoInstUrl&&URL.revokeObjectURL(this.videoInstUrl),e.getInstruction()){if(e.getInstruction().getImage()){var a=new Blob([e.getInstruction().getImage()],{type:"image"});this.imageInstUrl=URL.createObjectURL(a),t.imageInstUrl=this.imageInstUrl}if(e.getInstruction().getVideo()){var r=new Blob([e.getInstruction().getVideo()],{type:"video"});this.videoInstUrl=URL.createObjectURL(r),t.videoInstUrl=this.videoInstUrl}}return t}},{key:"render",value:function(){var e=this.props.element,t=j(e),a={};t===k.TRANSITION&&(a=this.prepareResource(e));var r=t===k.STATE?e.getProcessorsList().map(function(e){return{name:e.getName(),callable_name:e.getCallableName(),callable_args:JSON.parse(e.getCallableArgs())}}):e.getPredicatesList().map(function(e){return{name:e.getName(),callable_name:e.getCallableName(),callable_args:JSON.parse(e.getCallableArgs())}}),i=[{Header:"Name",accessor:"name",filterMethod:function(e,t){return Object(H.a)(t,e.value,{keys:["name"]})},filterAll:!0,width:ee(r,"name","Name")},{Header:"Type",accessor:"callable_name",filterMethod:function(e,t){return Object(H.a)(t,e.value,{keys:["callable_name"]})},filterAll:!0,width:ee(r,"callable_name","Type")},{Header:"Arguments",accessor:"callable_args",filterMethod:function(e,t){return Object(H.a)(t,e.value,{keys:["callable_args"]})},Cell:function(e){return n.a.createElement(Q.a,{src:e.value})},filterAll:!0}];return n.a.createElement(J.a,{style:{width:"100%",margin:"20px"}},n.a.createElement(q.a,{variant:"secondary"},"Name: ",e.getName()),n.a.createElement(q.a,{variant:"secondary"},"Type: ",t===k.STATE?"State":"Transition"),t===k.TRANSITION&&n.a.createElement(n.a.Fragment,null,n.a.createElement(q.a,{variant:"secondary"},"Instruction"),n.a.createElement(q.a,null,"Audio: ",e.getInstruction().getAudio()),a.imageInstUrl?n.a.createElement(q.a,null,"Image: ",n.a.createElement("img",{src:a.imageInstUrl,alt:"instruction",width:"100%",height:"100%"})):n.a.createElement(q.a,null,"Image: "),a.videoInstUrl?n.a.createElement(q.a,null,"Video: ",n.a.createElement(Z.a,{url:a.videoInstUrl,className:"react-player",controls:!0,light:!0,width:"100%",height:"100%"})):n.a.createElement(q.a,null,"Video: ")),n.a.createElement(q.a,{variant:"secondary"},t===k.STATE?"Processors":"Transition Predicates"),n.a.createElement(G.a,{data:r,filterable:!0,defaultFilterMethod:function(e,t){return String(t[e.id])===e.value},columns:i,defaultPageSize:3},function(e,t,a){return n.a.createElement("div",null,t())}))}}]),t}(r.Component),ae=a(16),re=a.n(ae),ne=a(131),ie=a.n(ne),oe=a(42),se=a.n(oe),le=a(48),ce=a.n(le),ue=function(e){var t=e.onImport,a=e.onAdd,r=e.onExport,i=e.onEdit,o=e.onDelete;return n.a.createElement(n.a.Fragment,null,n.a.createElement(f.a,null,n.a.createElement(ie.a,null,n.a.createElement(y.a,{sm:3},n.a.createElement(ce.a,{as:"buffer",onChange:t},n.a.createElement(re.a,{variant:"primary",className:"fw-btn"},"Import"))),n.a.createElement(y.a,{sm:3},n.a.createElement(re.a,{variant:"primary",onClick:r,className:"fw-btn"},"Export")),n.a.createElement(y.a,{sm:3},n.a.createElement(se.a,null,n.a.createElement(se.a.Toggle,{id:"dropdown-add",className:"fw-btn"},"Add"),n.a.createElement(se.a.Menu,null,n.a.createElement(se.a.Item,{onClick:function(){return a(k.STATE)}},"State"),n.a.createElement(se.a.Item,{onClick:function(){return a(k.TRANSITION)}},"Transition")))),n.a.createElement(y.a,{sm:3},n.a.createElement(re.a,{variant:"primary",onClick:i,className:"fw-btn"},"Edit")),n.a.createElement(y.a,{sm:3},n.a.createElement(re.a,{variant:"primary",onClick:o,className:"fw-btn"},"Delete")))))},pe=a(39),de=a.n(pe),me=a(83),ge=a(49),he=a(43),fe=a.n(he),be=a(11),ye=a.n(be),ve=a(20),Se=a(144),Ee=a(62),Me=Object(Ee.createFFmpeg)({log:!0}),Te=function(e){var t=null;return void 0!==e&&null!==e&&/^.+$/i.test(e)||(t="Required. Cannot be empty."),t},we=function(e,t){return Te(e)||function(e,t){var a=null;return(void 0===e||null===e||t.includes(e))&&(a="Duplicate name. All states and transitions must have unique names."),a}(e,t)||null},Ne=function(e){var t=e.field,a=e.type,r=e.label,i=e.placeholder,o=e.defaultValue,s=e.isValid,l=Object(ge.a)(e,["field","type","label","placeholder","defaultValue","isValid"]);return n.a.createElement(ye.a.Group,{as:f.a},n.a.createElement(ye.a.Label,{column:!0},r),n.a.createElement(y.a,null,n.a.createElement(ye.a.Control,Object.assign({required:!0},t,l,{type:a,placeholder:i,value:t.value||o||"",isValid:s}))))},Oe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).createThumbnail=function(){var e=Object(me.a)(de.a.mark(function e(t,a,r){var n;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Me.isLoaded()){e.next=3;break}return e.next=3,Me.load();case 3:return e.t0=Me,e.t1=a,e.next=7,Object(Ee.fetchFile)(t);case 7:return e.t2=e.sent,e.t0.FS.call(e.t0,"writeFile",e.t1,e.t2),n="out"+a+".png",e.next=12,Me.run("-ss",r,"-i",a,"-frames:v","1",n);case 12:return e.abrupt("return",Me.FS("readFile",n));case 13:case"end":return e.stop()}},e,this)}));return function(t,a,r){return e.apply(this,arguments)}}(),a.imageInstUrl=null,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"prepareResource",value:function(e){null!==this.imageInstUrl&&URL.revokeObjectURL(this.imageInstUrl);var t=new Blob([e],{type:"image"});return this.imageInstUrl=URL.createObjectURL(t),{imageInstUrl:this.imageInstUrl}}},{key:"render",value:function(){var e=this,t=this.props,a=t.field,r=t.form,i=t.label,o=t.url,s=t.vFilename,l=t.pos,c={};return a.value&&(c=this.prepareResource(a.value)),n.a.createElement(ye.a.Group,{as:f.a},n.a.createElement(ye.a.Label,{column:!0},i),c.imageInstUrl&&n.a.createElement(ye.a.Label,{column:!0,sm:1},n.a.createElement("img",{src:c.imageInstUrl,alt:"instruction",style:{width:40,height:40}})),n.a.createElement(y.a,null,n.a.createElement(ce.a,{as:"buffer",onChange:function(e,t){t.forEach(function(e){var t=e[0].target.result;r.setFieldValue(a.name,new Uint8Array(t))})}},n.a.createElement(re.a,{variant:"light",className:"fw-btn"},"New Image"))),n.a.createElement(y.a,null,n.a.createElement(re.a,{variant:"light",className:"fw-btn",onClick:function(){o&&e.createThumbnail(o,s,l).then(function(e){r.setFieldValue(a.name,e)})}},"Use Current Frame")))}}]),t}(r.Component),Fe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).createVideoClip=function(){var e=Object(me.a)(de.a.mark(function e(t,a,r,n){var i;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Me.isLoaded()){e.next=3;break}return e.next=3,Me.load();case 3:return e.t0=Me,e.t1=a,e.next=7,Object(Ee.fetchFile)(t);case 7:return e.t2=e.sent,e.t0.FS.call(e.t0,"writeFile",e.t1,e.t2),i="out"+a,e.next=12,Me.run("-ss",r,"-to",n,"-i",a,"-c","copy",i);case 12:return e.abrupt("return",Me.FS("readFile",i));case 13:case"end":return e.stop()}},e,this)}));return function(t,a,r,n){return e.apply(this,arguments)}}(),a.videoInstUrl=null,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"prepareResource",value:function(e){null!==this.videoInstUrl&&URL.revokeObjectURL(this.videoInstUrl);var t=new Blob([e],{type:"video"});return this.videoInstUrl=URL.createObjectURL(t),{videoInstUrl:this.videoInstUrl}}},{key:"render",value:function(){var e=this,t=this.props,a=t.field,r=t.form,i=t.label,o=t.url,s=t.vFilename,l=t.start,c=t.end,u={};return a.value&&(u=this.prepareResource(a.value)),n.a.createElement(ye.a.Group,{as:f.a},n.a.createElement(ye.a.Label,{column:!0},i),u.videoInstUrl&&n.a.createElement(ye.a.Label,{column:!0,sm:1},n.a.createElement("video",{width:"40"},n.a.createElement("source",{src:u.videoInstUrl}))),n.a.createElement(y.a,null,n.a.createElement(ce.a,{as:"buffer",onChange:function(e,t){t.forEach(function(e){var t=e[0].target.result;r.setFieldValue(a.name,new Uint8Array(t))})}},n.a.createElement(re.a,{variant:"light",className:"fw-btn"},"New Video"))),n.a.createElement(y.a,null,n.a.createElement(re.a,{variant:"light",className:"fw-btn",onClick:function(){if(o&&l&&c){var t=l.split(":"),n=c.split(":");3600*parseInt(t[0])+60*parseInt(t[1])+parseFloat(t[2])<3600*parseInt(n[0])+60*parseInt(n[1])+parseFloat(n[2])&&e.createVideoClip(o,s,l,c).then(function(e){r.setFieldValue(a.name,e)})}}},"Use Video Clip")))}}]),t}(r.Component),Ie=function(e){var t=e.field,a=e.form,r=e.label,i=e.selectOptions,o=Object(ge.a)(e,["field","form","label","selectOptions"]);return n.a.createElement(ye.a.Group,{as:f.a},n.a.createElement(ye.a.Label,{column:!0},r),n.a.createElement(y.a,null,n.a.createElement(Se.a,Object.assign({},t,o,{options:i,name:t.name,value:i?i.find(function(e){return e.value===t.value}):"",onChange:function(e){return a.setFieldValue(t.name,e.value)},onBlur:t.onBlur}))))},Ce=function(e){var t=e.field,a=Object(ge.a)(e,["field"]);return n.a.createElement(Ne,Object.assign({field:t,type:"text",label:"name",placeholder:"Enter Name"},a))},ke=function(e){var t=e.field,a=(e.key,e.label),r=e.placeholder,i=Object(ge.a)(e,["field","key","label","placeholder"]);return n.a.createElement(Ne,Object.assign({field:t,type:"text",label:a,placeholder:r},i))},je=function(e,t){return P(e,t)?n.a.createElement("div",{className:"text-danger"},P(e,t)):null},Be=function(e,t,a,r,i,o){var s=function(e){return Object.keys(e).map(function(e){return{value:e,label:e}})}(t);return n.a.createElement("div",{key:r,className:"border"},n.a.createElement("h6",null,e),n.a.createElement(ve.a,{name:"callable.".concat(r,".name"),component:Ce,validate:Te}),je(o,"callable.".concat(r,".name")),n.a.createElement(ve.a,{name:"callable.".concat(r,".type"),component:Ie,label:"Type",selectOptions:s,validate:Te}),je(o,"callable.".concat(r,".type")),P(a,"callable.".concat(r,".type"))&&Pe(t[a.callable[r].type],r,o),n.a.createElement(ye.a.Row,null,n.a.createElement(re.a,{variant:"danger",className:"btn-block",onClick:function(){return i.remove({index:r})}},"Delete")))},Pe=function(e,t,a){return Object.keys(e).map(function(r,i){return n.a.createElement("div",{key:t+".arg."+i},n.a.createElement(ve.a,{name:"callable.".concat(t,".args.").concat(r),component:ke,label:r,placeholder:e[r],defaultValue:"",validate:Te}),je(a,"callable.".concat(t,".args.").concat(r)))})},Re=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).form=n.a.createRef(),a.onHide=a.onHide.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"onHide",value:function(){}},{key:"getInitModalValuesFromElement",value:function(e,t){return null===e?{callable:[]}:_(e,t)}},{key:"render",value:function(){var e,t=this,a=this.props,r=a.show,i=a.type,o=a.fsm,s=a.onModalCancel,l=a.onModalSave,c=a.initElement,u=a.videoUrl,p=a.videoName,d=a.videoSeekPos,m=a.clipStart,g=a.clipEnd,h="",b=null,v="";switch(i){case k.STATE:e="State",h="New Processor",v="Add Processor",b=F;break;case k.TRANSITION:e="Transition",h="New Predicate",v="Add Predicate",b=I;break;default:throw new Error("Unsupported Element Type: "+i+". Failed to add a new element")}var S=this.getInitModalValuesFromElement(c,o);return n.a.createElement(fe.a,{show:r,onHide:this.onHide},n.a.createElement(fe.a.Header,null,n.a.createElement(fe.a.Title,null,e)),n.a.createElement(fe.a.Body,null,n.a.createElement(ve.d,{ref:this.form,initialValues:S,onSubmit:function(e,t){t.props;var a=t.setSubmitting;l(i,e,c),a(!1)},render:function(e){e.form;var t=e.values,a=e.errors;return n.a.createElement(ve.c,null,n.a.createElement(ve.b,{name:"callable",render:function(e){return n.a.createElement(n.a.Fragment,null,i===k.STATE&&n.a.createElement(n.a.Fragment,null,n.a.createElement(ve.a,{name:"name",component:Ne,type:"text",label:"Name",validate:function(e){if(null===c||void 0===c){var t=W(o);return we(e,t)}return Te(e)}}),je(a,"name"),n.a.createElement(ve.a,{name:"isStartState"},function(e){var a=e.field,r=e.form;return n.a.createElement(ye.a.Group,{as:f.a},n.a.createElement(ye.a.Label,{column:!0},"Start from this state?"),n.a.createElement(y.a,null,n.a.createElement(ye.a.Control,{type:"checkbox",checked:t[a.name]||"",onChange:function(){t[a.name]?r.setFieldValue(a.name,!1):r.setFieldValue(a.name,!0)}})))})),i===k.TRANSITION&&n.a.createElement(n.a.Fragment,null,n.a.createElement(ve.a,{name:"name",component:Ne,type:"text",label:"Name",validate:function(e){if(null===c||void 0===c){var t=W(o);return we(e,t)}return Te(e)}}),je(a,"name"),function(e,t,a,r,i,o,s,l){var c=e.getStatesList().map(function(e){return{value:e.getName(),label:e.getName()}});return n.a.createElement(n.a.Fragment,null,n.a.createElement(ve.a,{name:"from",component:Ie,label:"From State",selectOptions:c,validate:Te}),je(a,"from"),n.a.createElement(ve.a,{name:"to",component:Ie,label:"To State",selectOptions:c,validate:Te}),je(a,"to"),n.a.createElement(ve.a,{name:"instruction.audio",component:Ne,type:"text",label:"Audio Instruction",defaultValue:""}),n.a.createElement(ve.a,{name:"instruction.image",component:Oe,label:"Image Instruction",url:r,vFilename:i,pos:o}),n.a.createElement(ve.a,{name:"instruction.video",component:Fe,label:"Video Instruction",url:r,vFilename:i,start:s,end:l}))}(o,0,a,u,p,d,m,g)),t.callable.map(function(r,n){return Be(h,b,t,n,e,a)}),n.a.createElement(ye.a.Row,null,n.a.createElement(re.a,{variant:"info",className:"btn-block",onClick:function(){return e.push({})}},v)))}}))}})),n.a.createElement(fe.a.Footer,null,n.a.createElement(re.a,{variant:"secondary",onClick:s},"Close"),n.a.createElement(re.a,{variant:"primary",onClick:function(e){t.form.current.submitForm()}},"Save Changes")))}}]),t}(r.Component),Le=a(140),_e=a.n(Le),Ae=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.fsm.getStatesList().flatMap(function(e,t){var a=e.getName(),r=e.getProcessorsList();return void 0===r||0===r.length?[{state:a,processor:"",callable_name:"",callable_args:{}}]:r.map(function(e){return{state:a,processor:e.getName(),callable_name:e.getCallableName(),callable_args:JSON.parse(e.getCallableArgs())}})}),t=[{Header:"State",accessor:"state",filterMethod:function(e,t){return Object(H.a)(t,e.value,{keys:["state"]})},filterAll:!0,width:ee(e,"state","State")},{Header:"Processor",accessor:"processor",filterMethod:function(e,t){return Object(H.a)(t,e.value,{keys:["processor"]})},filterAll:!0,width:ee(e,"processor","Processor")},{Header:"Type",accessor:"callable_name",filterMethod:function(e,t){return Object(H.a)(t,e.value,{keys:["callable_name"]})},filterAll:!0,width:ee(e,"callable_name","Type")},{Header:"Arguments",accessor:"callable_args",filterMethod:function(e,t){return Object(H.a)(t,e.value,{keys:["callable_args"]})},Cell:function(e){return n.a.createElement(Q.a,{src:e.value})},filterAll:!0}];return n.a.createElement(G.a,{data:e,filterable:!0,defaultFilterMethod:function(e,t){return String(t[e.id])===e.value},columns:t,defaultPageSize:10},function(e,t,a){return n.a.createElement("div",null,t())})}}]),t}(r.Component),Ue=a(95);var We=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onChooseFile=function(e){null!==a.state.videoUrl&&(URL.revokeObjectURL(a.state.videoUrl),a.clipStart.current.value=null,a.clipEnd.current.value=null);var t=URL.createObjectURL(e.target.files[0]);a.setState({videoUrl:t,videoName:e.target.files[0].name})},a.handleProgress=function(e){var t=e.playedSeconds,r=Math.floor(t/3600),n=Math.floor(t/60)%60,i=t-3600*r-60*n,o=[r<10?"0"+r:""+r,n<10?"0"+n:""+n,i<10?"0"+Math.floor(1e3*i)/1e3:""+Math.floor(1e3*i)/1e3].join(":");a.setState({playedSeconds:o})},a.diagramRef=n.a.createRef(),a.diagramContainerRef=n.a.createRef(),a.alert=a.alert.bind(Object(d.a)(Object(d.a)(a))),a.onImport=a.onImport.bind(Object(d.a)(Object(d.a)(a))),a.onExport=a.onExport.bind(Object(d.a)(Object(d.a)(a))),a.onAdd=a.onAdd.bind(Object(d.a)(Object(d.a)(a))),a.onDelete=a.onDelete.bind(Object(d.a)(Object(d.a)(a))),a.onEdit=a.onEdit.bind(Object(d.a)(Object(d.a)(a))),a.onClickCell=a.onClickCell.bind(Object(d.a)(Object(d.a)(a))),a.onClickBlank=a.onClickBlank.bind(Object(d.a)(Object(d.a)(a))),a.onModalCancel=a.onModalCancel.bind(Object(d.a)(Object(d.a)(a))),a.onModalSave=a.onModalSave.bind(Object(d.a)(Object(d.a)(a))),a.clipStart=n.a.createRef(),a.clipEnd=n.a.createRef(),a.state={fsm:new Ue.StateMachine,curFSMElement:null,modalInitElement:null,alertMsg:{show:!0,type:"info",msg:"Welcome to State Machine Editor!"},showNewElementModal:!1,newElementModalType:null,videoUrl:null,videoName:null,playedSeconds:null},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(g.a,{fluid:!0},n.a.createElement("h1",null,"OpenWorkflow State Machine Editor"),""!==this.state.alertMsg.msg&&n.a.createElement(S.a,{dismissible:!0,variant:this.state.alertMsg.type},this.state.alertMsg.msg),n.a.createElement(f.a,null,n.a.createElement(y.a,{sm:3},n.a.createElement("h4",null,"Upload Video"),n.a.createElement("div",{className:"player-wrapper"},n.a.createElement("input",{onChange:this.onChooseFile,type:"file",accept:"video/*"}),n.a.createElement(Z.a,{url:this.state.videoUrl,className:"react-player",controls:!0,width:"100%",height:"100%",onProgress:this.handleProgress}),this.state.videoUrl&&n.a.createElement(ye.a,null,n.a.createElement(ye.a.Group,{as:f.a},n.a.createElement(ye.a.Label,{column:!0},"Video Clip Start"),n.a.createElement(y.a,null,n.a.createElement(ye.a.Control,{type:"text",placeholder:"HH:mm:ss.xxx",ref:this.clipStart,readOnly:!0}),n.a.createElement(re.a,{variant:"primary",className:"fw-btn",onClick:function(){e.clipStart.current.value=e.state.playedSeconds}},"Use Current Frame"))),n.a.createElement(ye.a.Group,{as:f.a},n.a.createElement(ye.a.Label,{column:!0},"Video Clip End"),n.a.createElement(y.a,null,n.a.createElement(ye.a.Control,{type:"text",placeholder:"HH:mm:ss.xxx",ref:this.clipEnd,readOnly:!0}),n.a.createElement(re.a,{variant:"primary",className:"fw-btn",onClick:function(){e.clipEnd.current.value=e.state.playedSeconds}},"Use Current Frame")))))),n.a.createElement(y.a,{sm:4,ref:this.diagramContainerRef,style:{backgroundColor:"lavender"}},n.a.createElement("h4",null,"Diagram"),n.a.createElement(D,{fsm:this.state.fsm,onClickCell:this.onClickCell,onClickBlank:this.onClickBlank,ref:this.diagramRef,paperWidth:window.innerWidth/3})),n.a.createElement(y.a,{sm:5},n.a.createElement(ue,{onImport:this.onImport,onAdd:this.onAdd,onExport:this.onExport,onDelete:this.onDelete,onEdit:this.onEdit}),this.state.curFSMElement?n.a.createElement(f.a,null,n.a.createElement(te,{element:this.state.curFSMElement,style:{width:"100%"}})):n.a.createElement("div",null,n.a.createElement(Ae,{fsm:this.state.fsm})))),n.a.createElement("footer",null,n.a.createElement(g.a,null,n.a.createElement("span",{className:"text-muted"},"Copyright Carnegie Mellon University"))),this.state.showNewElementModal&&n.a.createElement(Re,{fsm:this.state.fsm,show:this.state.showNewElementModal,type:this.state.newElementModalType,initElement:this.state.modalInitElement,onModalSave:this.onModalSave,onModalCancel:this.onModalCancel,videoUrl:this.state.videoUrl,videoName:this.state.videoName,videoSeekPos:this.state.playedSeconds,clipStart:this.clipStart.current?this.clipStart.current.value:null,clipEnd:this.clipEnd.current?this.clipEnd.current.value:null}))}},{key:"alert",value:function(e,t){this.setState({alertMsg:{type:e,msg:t}})}},{key:"onImport",value:function(e,t){var a=this;t.forEach(function(e){var t=e[0].target.result,r=null;try{r=function(e){var t=null;try{t=Ue.StateMachine.deserializeBinary(e)}catch(a){throw"Incorrect file format. "+a}if(t&&!U(t))throw"FSM contains duplicate names! For this web editor to work properly, all states and transitions need to have unique names.If you create the FSM using the python library, make sure to assign unique names for states and transitions.";return t}(t),a.setState({fsm:r,curFSMElement:null}),a.alert("info","Success! State machine imported.")}catch(n){a.alert("danger","Failed to import the file. \n"+n)}})}},{key:"onExport",value:function(){var e=this.state.fsm;if(0===e.getStatesList().length)this.alert("danger","Empty state machine! There is nothing to save. \n");else{""===e.getStartState()&&e.setStartState(e.getStatesList()[0].getName());var t=e.serializeBinary(),a=new Blob([t],{type:"application/octet-stream"});_e()(a,"app.pbfsm")}}},{key:"onAdd",value:function(e){this.setState({showNewElementModal:!0,newElementModalType:e})}},{key:"isElementSafeToDelete",value:function(e){var t=this.state.fsm,a=j(e),r=!0;switch(a){case k.STATE:return e.getTransitionsList().length>0&&(r=!1),t.getStatesList().map(function(t){return t.getTransitionsList().map(function(t){return t.getNextState()===e.getName()&&(r=!1),null}),null}),r;case k.TRANSITION:return r;default:throw new Error("Unsupported Element Type: "+a)}}},{key:"deleteStatePb",value:function(e){var t=this.state.fsm;if(!this.isElementSafeToDelete(e))return this.alert("danger","A state cannot be deleted unless all transitions to/from it have been deleted.");var a=t.getStatesList().indexOf(e);t.getStatesList().splice(a,1),this.setState({fsm:t,curFSMElement:null})}},{key:"deleteTransitionPb",value:function(e){var t=this.state.fsm;if(!this.isElementSafeToDelete(e))return this.alert("danger","The transition cannot be safely deleted");t.getStatesList().map(function(t){var a=t.getTransitionsList().indexOf(e);return a>=0&&t.getTransitionsList().splice(a,a+1),null}),this.setState({fsm:t,curFSMElement:null})}},{key:"hasCurElement",value:function(){return null!==this.state.curFSMElement||(this.alert("danger","There is no element selected. Double-click to select an element."),!1)}},{key:"onEdit",value:function(){if(this.hasCurElement()){var e=this.state.curFSMElement,t=j(e);this.setState({showNewElementModal:!0,newElementModalType:t,modalInitElement:e})}}},{key:"onDelete",value:function(){if(this.hasCurElement()){var e=this.state.curFSMElement,t=j(e);switch(t){case k.STATE:this.deleteStatePb(e);break;case k.TRANSITION:this.deleteTransitionPb(e);break;default:throw new Error("Unsupported Element Type: "+t)}}}},{key:"onClickCell",value:function(e){var t=this.diagramRef.current.cellId2FSMElement[e.model.id];this.setState({curFSMElement:t})}},{key:"onClickBlank",value:function(e){this.setState({curFSMElement:null})}},{key:"onModalSave",value:function(e,t,a){var r=this.state.fsm;try{x(t,r,e,a),this.setState({fsm:r}),this.setState({showNewElementModal:!1,modalInitElement:null})}catch(n){this.setState({showNewElementModal:!1,modalInitElement:null}),this.alert("danger",n)}}},{key:"onModalCancel",value:function(){this.setState({showNewElementModal:!1,modalInitElement:null})}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(We,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},54:function(e){e.exports={TFServingContainerCallable:{model_name:"",serving_dir:"relative_path_to_tf_savedmodel_dir",conf_threshold:"0.8"},FasterRCNNContainerProcessor:{container_image_url:"",conf_threshold:"0.8"},FasterRCNNOpenCVProcessor:{proto_path:"",model_path:"",labels:"None",conf_threshold:"0.8"},YoloProcessor:{model_path:"",conf_threshold:"0.8"},TwoStageProcessor:{classifier_path:"",detector_path:"",detector_class_name:"",conf_threshold:"0.4"},GatedTwoStageProcessor:{classifier_path:"",detector_path:"",detector_class_name:"",conf_threshold:"0.4",thumbs_up_required:"True/False",transition_word:"-"},DummyProcessor:{dummy_input:"dummy_input_value"}}},55:function(e){e.exports={Always:{},HasObjectClass:{class_name:""},HasObjectClassWhileNotOthers:{has_classes:"",absent_classes:""},Wait:{wait_time:""}}},65:function(e,t,a){},95:function(e,t,a){var r=a(192),n=r,i=Function("return this")();n.exportSymbol("proto.Instruction",null,i),n.exportSymbol("proto.Processor",null,i),n.exportSymbol("proto.State",null,i),n.exportSymbol("proto.StateMachine",null,i),n.exportSymbol("proto.Transition",null,i),n.exportSymbol("proto.TransitionPredicate",null,i),proto.TransitionPredicate=function(e){r.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.TransitionPredicate,r.Message),n.DEBUG&&!COMPILED&&(proto.TransitionPredicate.displayName="proto.TransitionPredicate"),r.Message.GENERATE_TO_OBJECT&&(proto.TransitionPredicate.prototype.toObject=function(e){return proto.TransitionPredicate.toObject(e,this)},proto.TransitionPredicate.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),callableName:r.Message.getFieldWithDefault(t,2,""),callableKwargsMap:(a=t.getCallableKwargsMap())?a.toObject(e,void 0):[],callableArgs:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.TransitionPredicate.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.TransitionPredicate;return proto.TransitionPredicate.deserializeBinaryFromReader(a,t)},proto.TransitionPredicate.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=t.readString();e.setCallableName(a);break;case 3:a=e.getCallableKwargsMap();t.readMessage(a,function(e,t){r.Map.deserializeBinary(e,t,r.BinaryReader.prototype.readString,r.BinaryReader.prototype.readBytes,null,"")});break;case 4:a=t.readString();e.setCallableArgs(a);break;default:t.skipField()}}return e},proto.TransitionPredicate.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.TransitionPredicate.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.TransitionPredicate.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getCallableName()).length>0&&t.writeString(2,a),(a=e.getCallableKwargsMap(!0))&&a.getLength()>0&&a.serializeBinary(3,t,r.BinaryWriter.prototype.writeString,r.BinaryWriter.prototype.writeBytes),(a=e.getCallableArgs()).length>0&&t.writeString(4,a)},proto.TransitionPredicate.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.TransitionPredicate.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.TransitionPredicate.prototype.getCallableName=function(){return r.Message.getFieldWithDefault(this,2,"")},proto.TransitionPredicate.prototype.setCallableName=function(e){r.Message.setProto3StringField(this,2,e)},proto.TransitionPredicate.prototype.getCallableKwargsMap=function(e){return r.Message.getMapField(this,3,e,null)},proto.TransitionPredicate.prototype.clearCallableKwargsMap=function(){this.getCallableKwargsMap().clear()},proto.TransitionPredicate.prototype.getCallableArgs=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.TransitionPredicate.prototype.setCallableArgs=function(e){r.Message.setProto3StringField(this,4,e)},proto.Instruction=function(e){r.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.Instruction,r.Message),n.DEBUG&&!COMPILED&&(proto.Instruction.displayName="proto.Instruction"),r.Message.GENERATE_TO_OBJECT&&(proto.Instruction.prototype.toObject=function(e){return proto.Instruction.toObject(e,this)},proto.Instruction.toObject=function(e,t){var a={name:r.Message.getFieldWithDefault(t,1,""),audio:r.Message.getFieldWithDefault(t,2,""),image:t.getImage_asB64(),video:t.getVideo_asB64()};return e&&(a.$jspbMessageInstance=t),a}),proto.Instruction.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.Instruction;return proto.Instruction.deserializeBinaryFromReader(a,t)},proto.Instruction.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=t.readString();e.setAudio(a);break;case 3:a=t.readBytes();e.setImage(a);break;case 4:a=t.readBytes();e.setVideo(a);break;default:t.skipField()}}return e},proto.Instruction.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.Instruction.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.Instruction.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getAudio()).length>0&&t.writeString(2,a),(a=e.getImage_asU8()).length>0&&t.writeBytes(3,a),(a=e.getVideo_asU8()).length>0&&t.writeBytes(4,a)},proto.Instruction.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.Instruction.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.Instruction.prototype.getAudio=function(){return r.Message.getFieldWithDefault(this,2,"")},proto.Instruction.prototype.setAudio=function(e){r.Message.setProto3StringField(this,2,e)},proto.Instruction.prototype.getImage=function(){return r.Message.getFieldWithDefault(this,3,"")},proto.Instruction.prototype.getImage_asB64=function(){return r.Message.bytesAsB64(this.getImage())},proto.Instruction.prototype.getImage_asU8=function(){return r.Message.bytesAsU8(this.getImage())},proto.Instruction.prototype.setImage=function(e){r.Message.setProto3BytesField(this,3,e)},proto.Instruction.prototype.getVideo=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.Instruction.prototype.getVideo_asB64=function(){return r.Message.bytesAsB64(this.getVideo())},proto.Instruction.prototype.getVideo_asU8=function(){return r.Message.bytesAsU8(this.getVideo())},proto.Instruction.prototype.setVideo=function(e){r.Message.setProto3BytesField(this,4,e)},proto.Transition=function(e){r.Message.initialize(this,e,0,-1,proto.Transition.repeatedFields_,null)},n.inherits(proto.Transition,r.Message),n.DEBUG&&!COMPILED&&(proto.Transition.displayName="proto.Transition"),proto.Transition.repeatedFields_=[2],r.Message.GENERATE_TO_OBJECT&&(proto.Transition.prototype.toObject=function(e){return proto.Transition.toObject(e,this)},proto.Transition.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),predicatesList:r.Message.toObjectList(t.getPredicatesList(),proto.TransitionPredicate.toObject,e),instruction:(a=t.getInstruction())&&proto.Instruction.toObject(e,a),nextState:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.Transition.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.Transition;return proto.Transition.deserializeBinaryFromReader(a,t)},proto.Transition.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=new proto.TransitionPredicate;t.readMessage(a,proto.TransitionPredicate.deserializeBinaryFromReader),e.addPredicates(a);break;case 3:a=new proto.Instruction;t.readMessage(a,proto.Instruction.deserializeBinaryFromReader),e.setInstruction(a);break;case 4:a=t.readString();e.setNextState(a);break;default:t.skipField()}}return e},proto.Transition.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.Transition.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.Transition.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getPredicatesList()).length>0&&t.writeRepeatedMessage(2,a,proto.TransitionPredicate.serializeBinaryToWriter),null!=(a=e.getInstruction())&&t.writeMessage(3,a,proto.Instruction.serializeBinaryToWriter),(a=e.getNextState()).length>0&&t.writeString(4,a)},proto.Transition.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.Transition.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.Transition.prototype.getPredicatesList=function(){return r.Message.getRepeatedWrapperField(this,proto.TransitionPredicate,2)},proto.Transition.prototype.setPredicatesList=function(e){r.Message.setRepeatedWrapperField(this,2,e)},proto.Transition.prototype.addPredicates=function(e,t){return r.Message.addToRepeatedWrapperField(this,2,e,proto.TransitionPredicate,t)},proto.Transition.prototype.clearPredicatesList=function(){this.setPredicatesList([])},proto.Transition.prototype.getInstruction=function(){return r.Message.getWrapperField(this,proto.Instruction,3)},proto.Transition.prototype.setInstruction=function(e){r.Message.setWrapperField(this,3,e)},proto.Transition.prototype.clearInstruction=function(){this.setInstruction(void 0)},proto.Transition.prototype.hasInstruction=function(){return null!=r.Message.getField(this,3)},proto.Transition.prototype.getNextState=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.Transition.prototype.setNextState=function(e){r.Message.setProto3StringField(this,4,e)},proto.Processor=function(e){r.Message.initialize(this,e,0,-1,null,null)},n.inherits(proto.Processor,r.Message),n.DEBUG&&!COMPILED&&(proto.Processor.displayName="proto.Processor"),r.Message.GENERATE_TO_OBJECT&&(proto.Processor.prototype.toObject=function(e){return proto.Processor.toObject(e,this)},proto.Processor.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),callableName:r.Message.getFieldWithDefault(t,2,""),callableKwargsMap:(a=t.getCallableKwargsMap())?a.toObject(e,void 0):[],callableArgs:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.Processor.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.Processor;return proto.Processor.deserializeBinaryFromReader(a,t)},proto.Processor.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=t.readString();e.setCallableName(a);break;case 3:a=e.getCallableKwargsMap();t.readMessage(a,function(e,t){r.Map.deserializeBinary(e,t,r.BinaryReader.prototype.readString,r.BinaryReader.prototype.readBytes,null,"")});break;case 4:a=t.readString();e.setCallableArgs(a);break;default:t.skipField()}}return e},proto.Processor.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.Processor.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.Processor.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getCallableName()).length>0&&t.writeString(2,a),(a=e.getCallableKwargsMap(!0))&&a.getLength()>0&&a.serializeBinary(3,t,r.BinaryWriter.prototype.writeString,r.BinaryWriter.prototype.writeBytes),(a=e.getCallableArgs()).length>0&&t.writeString(4,a)},proto.Processor.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.Processor.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.Processor.prototype.getCallableName=function(){return r.Message.getFieldWithDefault(this,2,"")},proto.Processor.prototype.setCallableName=function(e){r.Message.setProto3StringField(this,2,e)},proto.Processor.prototype.getCallableKwargsMap=function(e){return r.Message.getMapField(this,3,e,null)},proto.Processor.prototype.clearCallableKwargsMap=function(){this.getCallableKwargsMap().clear()},proto.Processor.prototype.getCallableArgs=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.Processor.prototype.setCallableArgs=function(e){r.Message.setProto3StringField(this,4,e)},proto.State=function(e){r.Message.initialize(this,e,0,-1,proto.State.repeatedFields_,null)},n.inherits(proto.State,r.Message),n.DEBUG&&!COMPILED&&(proto.State.displayName="proto.State"),proto.State.repeatedFields_=[2,3],r.Message.GENERATE_TO_OBJECT&&(proto.State.prototype.toObject=function(e){return proto.State.toObject(e,this)},proto.State.toObject=function(e,t){var a={name:r.Message.getFieldWithDefault(t,1,""),processorsList:r.Message.toObjectList(t.getProcessorsList(),proto.Processor.toObject,e),transitionsList:r.Message.toObjectList(t.getTransitionsList(),proto.Transition.toObject,e)};return e&&(a.$jspbMessageInstance=t),a}),proto.State.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.State;return proto.State.deserializeBinaryFromReader(a,t)},proto.State.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=new proto.Processor;t.readMessage(a,proto.Processor.deserializeBinaryFromReader),e.addProcessors(a);break;case 3:a=new proto.Transition;t.readMessage(a,proto.Transition.deserializeBinaryFromReader),e.addTransitions(a);break;default:t.skipField()}}return e},proto.State.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.State.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.State.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getProcessorsList()).length>0&&t.writeRepeatedMessage(2,a,proto.Processor.serializeBinaryToWriter),(a=e.getTransitionsList()).length>0&&t.writeRepeatedMessage(3,a,proto.Transition.serializeBinaryToWriter)},proto.State.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.State.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.State.prototype.getProcessorsList=function(){return r.Message.getRepeatedWrapperField(this,proto.Processor,2)},proto.State.prototype.setProcessorsList=function(e){r.Message.setRepeatedWrapperField(this,2,e)},proto.State.prototype.addProcessors=function(e,t){return r.Message.addToRepeatedWrapperField(this,2,e,proto.Processor,t)},proto.State.prototype.clearProcessorsList=function(){this.setProcessorsList([])},proto.State.prototype.getTransitionsList=function(){return r.Message.getRepeatedWrapperField(this,proto.Transition,3)},proto.State.prototype.setTransitionsList=function(e){r.Message.setRepeatedWrapperField(this,3,e)},proto.State.prototype.addTransitions=function(e,t){return r.Message.addToRepeatedWrapperField(this,3,e,proto.Transition,t)},proto.State.prototype.clearTransitionsList=function(){this.setTransitionsList([])},proto.StateMachine=function(e){r.Message.initialize(this,e,0,-1,proto.StateMachine.repeatedFields_,null)},n.inherits(proto.StateMachine,r.Message),n.DEBUG&&!COMPILED&&(proto.StateMachine.displayName="proto.StateMachine"),proto.StateMachine.repeatedFields_=[2],r.Message.GENERATE_TO_OBJECT&&(proto.StateMachine.prototype.toObject=function(e){return proto.StateMachine.toObject(e,this)},proto.StateMachine.toObject=function(e,t){var a,n={name:r.Message.getFieldWithDefault(t,1,""),statesList:r.Message.toObjectList(t.getStatesList(),proto.State.toObject,e),assetsMap:(a=t.getAssetsMap())?a.toObject(e,void 0):[],startState:r.Message.getFieldWithDefault(t,4,"")};return e&&(n.$jspbMessageInstance=t),n}),proto.StateMachine.deserializeBinary=function(e){var t=new r.BinaryReader(e),a=new proto.StateMachine;return proto.StateMachine.deserializeBinaryFromReader(a,t)},proto.StateMachine.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var a=t.readString();e.setName(a);break;case 2:a=new proto.State;t.readMessage(a,proto.State.deserializeBinaryFromReader),e.addStates(a);break;case 3:a=e.getAssetsMap();t.readMessage(a,function(e,t){r.Map.deserializeBinary(e,t,r.BinaryReader.prototype.readString,r.BinaryReader.prototype.readBytes,null,"")});break;case 4:a=t.readString();e.setStartState(a);break;default:t.skipField()}}return e},proto.StateMachine.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.StateMachine.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.StateMachine.serializeBinaryToWriter=function(e,t){var a=void 0;(a=e.getName()).length>0&&t.writeString(1,a),(a=e.getStatesList()).length>0&&t.writeRepeatedMessage(2,a,proto.State.serializeBinaryToWriter),(a=e.getAssetsMap(!0))&&a.getLength()>0&&a.serializeBinary(3,t,r.BinaryWriter.prototype.writeString,r.BinaryWriter.prototype.writeBytes),(a=e.getStartState()).length>0&&t.writeString(4,a)},proto.StateMachine.prototype.getName=function(){return r.Message.getFieldWithDefault(this,1,"")},proto.StateMachine.prototype.setName=function(e){r.Message.setProto3StringField(this,1,e)},proto.StateMachine.prototype.getStatesList=function(){return r.Message.getRepeatedWrapperField(this,proto.State,2)},proto.StateMachine.prototype.setStatesList=function(e){r.Message.setRepeatedWrapperField(this,2,e)},proto.StateMachine.prototype.addStates=function(e,t){return r.Message.addToRepeatedWrapperField(this,2,e,proto.State,t)},proto.StateMachine.prototype.clearStatesList=function(){this.setStatesList([])},proto.StateMachine.prototype.getAssetsMap=function(e){return r.Message.getMapField(this,3,e,null)},proto.StateMachine.prototype.clearAssetsMap=function(){this.getAssetsMap().clear()},proto.StateMachine.prototype.getStartState=function(){return r.Message.getFieldWithDefault(this,4,"")},proto.StateMachine.prototype.setStartState=function(e){r.Message.setProto3StringField(this,4,e)},n.object.extend(t,proto)}},[[145,2,1]]]);